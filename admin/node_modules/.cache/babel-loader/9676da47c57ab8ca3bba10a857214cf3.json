{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\OneDrive\\\\Desktop\\\\BusEase\\\\admin\\\\src\\\\components\\\\BookingManagement\\\\BookingManagement.jsx\",\n    _s = $RefreshSig$();\n\n// src/pages/booking/BookingManagement.jsx\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { getAllBookings, deleteBooking, updateBooking, getUserBookings } from '../../api/bookingApi';\nimport './BookingManagement.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst BookingManagement = () => {\n  _s();\n\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [selectedBooking, setSelectedBooking] = useState(null);\n  const [editMode, setEditMode] = useState(false);\n  const [formData, setFormData] = useState({\n    user: '',\n    schedule: '',\n    seatNumbers: '',\n    totalPrice: '',\n    status: ''\n  });\n  useEffect(() => {\n    const fetchBookings = async () => {\n      try {\n        const {\n          data\n        } = await getAllBookings();\n        setBookings(data);\n      } catch (err) {\n        setError('Failed to fetch bookings');\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchBookings();\n  }, []);\n\n  const handleEditClick = async id => {\n    try {\n      const {\n        data\n      } = await getUserBookings(id);\n      setSelectedBooking(data);\n      setFormData({\n        user: data.user._id,\n        schedule: data.schedule._id,\n        seatNumbers: data.seatNumbers.join(', '),\n        // Convert array to comma-separated string\n        totalPrice: data.totalPrice,\n        status: data.status\n      });\n      setEditMode(true);\n    } catch (err) {\n      console.error('Failed to fetch booking data:', err);\n      setError('Failed to fetch booking data');\n    }\n  };\n\n  const handleFormChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFormData({ ...formData,\n      [name]: value\n    });\n  };\n\n  const handleConfirmEdit = async () => {\n    setError(null);\n\n    try {\n      // Convert seatNumbers from string to array of numbers\n      const seatNumbersArray = formData.seatNumbers.split(',').map(num => parseInt(num.trim(), 10));\n      const updatedBooking = {\n        user: formData.user,\n        schedule: formData.schedule,\n        seatNumbers: seatNumbersArray,\n        totalPrice: formData.totalPrice,\n        status: formData.status\n      };\n      const {\n        data\n      } = await updateBooking(selectedBooking._id, updatedBooking);\n      setBookings(bookings.map(booking => booking._id === selectedBooking._id ? data : booking));\n      setEditMode(false);\n      setSelectedBooking(null);\n    } catch (err) {\n      console.error('Failed to update booking:', err);\n      setError('Failed to update booking');\n    }\n  };\n\n  const handleDelete = async id => {\n    try {\n      await deleteBooking(id);\n      setBookings(bookings.filter(booking => booking._id !== id));\n    } catch (err) {\n      console.error('Failed to delete booking:', err);\n      setError('Failed to delete booking');\n    }\n  };\n\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading bookings...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 25\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 23\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bookingManagement\",\n    children: editMode ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"editForm\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Edit Booking\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"User ID:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"user\",\n        value: formData.user,\n        onChange: handleFormChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Schedule ID:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"schedule\",\n        value: formData.schedule,\n        onChange: handleFormChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Seat Numbers (comma-separated):\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"seatNumbers\",\n        value: formData.seatNumbers,\n        onChange: handleFormChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Total Price:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        name: \"totalPrice\",\n        value: formData.totalPrice,\n        onChange: handleFormChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Status:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        name: \"status\",\n        value: formData.status,\n        onChange: handleFormChange,\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"ongoing\",\n          children: \"Ongoing\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"completed\",\n          children: \"Completed\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"cancelled\",\n          children: \"Cancelled\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleConfirmEdit,\n        children: \"Edit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setEditMode(false),\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"managementTable\",\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Booking ID\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"User\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Schedule\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Seat Numbers\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Total Price\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Actions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: bookings.map(booking => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: booking._id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: booking.user.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: booking.schedule.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: booking.seatNumbers.join(', ')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: booking.totalPrice\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: booking.status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleEditClick(booking._id),\n              children: \"View\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleDelete(booking._id),\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 33\n          }, this)]\n        }, booking._id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 9\n  }, this);\n};\n\n_s(BookingManagement, \"TIcV8J+YVIGwK6t7Fzm66mMZhUA=\");\n\n_c = BookingManagement;\nexport default BookingManagement;\n\nvar _c;\n\n$RefreshReg$(_c, \"BookingManagement\");","map":{"version":3,"sources":["C:/Users/user/OneDrive/Desktop/BusEase/admin/src/components/BookingManagement/BookingManagement.jsx"],"names":["React","useEffect","useState","axios","getAllBookings","deleteBooking","updateBooking","getUserBookings","BookingManagement","bookings","setBookings","loading","setLoading","error","setError","selectedBooking","setSelectedBooking","editMode","setEditMode","formData","setFormData","user","schedule","seatNumbers","totalPrice","status","fetchBookings","data","err","console","handleEditClick","id","_id","join","handleFormChange","e","name","value","target","handleConfirmEdit","seatNumbersArray","split","map","num","parseInt","trim","updatedBooking","booking","handleDelete","filter","username"],"mappings":";;;AAAA;AACA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,cAAT,EAAyBC,aAAzB,EAAwCC,aAAxC,EAAuDC,eAAvD,QAA8E,sBAA9E;AACA,OAAO,yBAAP;;;AAEA,MAAMC,iBAAiB,GAAG,MAAM;AAAA;;AAC5B,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BR,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACS,OAAD,EAAUC,UAAV,IAAwBV,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM,CAACW,KAAD,EAAQC,QAAR,IAAoBZ,QAAQ,CAAC,IAAD,CAAlC;AACA,QAAM,CAACa,eAAD,EAAkBC,kBAAlB,IAAwCd,QAAQ,CAAC,IAAD,CAAtD;AACA,QAAM,CAACe,QAAD,EAAWC,WAAX,IAA0BhB,QAAQ,CAAC,KAAD,CAAxC;AACA,QAAM,CAACiB,QAAD,EAAWC,WAAX,IAA0BlB,QAAQ,CAAC;AACrCmB,IAAAA,IAAI,EAAE,EAD+B;AAErCC,IAAAA,QAAQ,EAAE,EAF2B;AAGrCC,IAAAA,WAAW,EAAE,EAHwB;AAIrCC,IAAAA,UAAU,EAAE,EAJyB;AAKrCC,IAAAA,MAAM,EAAE;AAL6B,GAAD,CAAxC;AAQAxB,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMyB,aAAa,GAAG,YAAY;AAC9B,UAAI;AACA,cAAM;AAAEC,UAAAA;AAAF,YAAW,MAAMvB,cAAc,EAArC;AACAM,QAAAA,WAAW,CAACiB,IAAD,CAAX;AACH,OAHD,CAGE,OAAOC,GAAP,EAAY;AACVd,QAAAA,QAAQ,CAAC,0BAAD,CAAR;AACAe,QAAAA,OAAO,CAAChB,KAAR,CAAce,GAAd;AACH,OAND,SAMU;AACNhB,QAAAA,UAAU,CAAC,KAAD,CAAV;AACH;AACJ,KAVD;;AAWAc,IAAAA,aAAa;AAChB,GAbQ,EAaN,EAbM,CAAT;;AAeA,QAAMI,eAAe,GAAG,MAAOC,EAAP,IAAc;AAClC,QAAI;AACA,YAAM;AAAEJ,QAAAA;AAAF,UAAW,MAAMpB,eAAe,CAACwB,EAAD,CAAtC;AACAf,MAAAA,kBAAkB,CAACW,IAAD,CAAlB;AACAP,MAAAA,WAAW,CAAC;AACRC,QAAAA,IAAI,EAAEM,IAAI,CAACN,IAAL,CAAUW,GADR;AAERV,QAAAA,QAAQ,EAAEK,IAAI,CAACL,QAAL,CAAcU,GAFhB;AAGRT,QAAAA,WAAW,EAAEI,IAAI,CAACJ,WAAL,CAAiBU,IAAjB,CAAsB,IAAtB,CAHL;AAGkC;AAC1CT,QAAAA,UAAU,EAAEG,IAAI,CAACH,UAJT;AAKRC,QAAAA,MAAM,EAAEE,IAAI,CAACF;AALL,OAAD,CAAX;AAOAP,MAAAA,WAAW,CAAC,IAAD,CAAX;AACH,KAXD,CAWE,OAAOU,GAAP,EAAY;AACVC,MAAAA,OAAO,CAAChB,KAAR,CAAc,+BAAd,EAA+Ce,GAA/C;AACAd,MAAAA,QAAQ,CAAC,8BAAD,CAAR;AACH;AACJ,GAhBD;;AAkBA,QAAMoB,gBAAgB,GAAIC,CAAD,IAAO;AAC5B,UAAM;AAAEC,MAAAA,IAAF;AAAQC,MAAAA;AAAR,QAAkBF,CAAC,CAACG,MAA1B;AACAlB,IAAAA,WAAW,CAAC,EAAE,GAAGD,QAAL;AAAe,OAACiB,IAAD,GAAQC;AAAvB,KAAD,CAAX;AACH,GAHD;;AAKA,QAAME,iBAAiB,GAAG,YAAY;AAClCzB,IAAAA,QAAQ,CAAC,IAAD,CAAR;;AAEA,QAAI;AACA;AACA,YAAM0B,gBAAgB,GAAGrB,QAAQ,CAACI,WAAT,CACpBkB,KADoB,CACd,GADc,EAEpBC,GAFoB,CAEhBC,GAAG,IAAIC,QAAQ,CAACD,GAAG,CAACE,IAAJ,EAAD,EAAa,EAAb,CAFC,CAAzB;AAIA,YAAMC,cAAc,GAAG;AACnBzB,QAAAA,IAAI,EAAEF,QAAQ,CAACE,IADI;AAEnBC,QAAAA,QAAQ,EAAEH,QAAQ,CAACG,QAFA;AAGnBC,QAAAA,WAAW,EAAEiB,gBAHM;AAInBhB,QAAAA,UAAU,EAAEL,QAAQ,CAACK,UAJF;AAKnBC,QAAAA,MAAM,EAAEN,QAAQ,CAACM;AALE,OAAvB;AAQA,YAAM;AAAEE,QAAAA;AAAF,UAAW,MAAMrB,aAAa,CAACS,eAAe,CAACiB,GAAjB,EAAsBc,cAAtB,CAApC;AAEApC,MAAAA,WAAW,CAACD,QAAQ,CAACiC,GAAT,CAAaK,OAAO,IAAIA,OAAO,CAACf,GAAR,KAAgBjB,eAAe,CAACiB,GAAhC,GAAsCL,IAAtC,GAA6CoB,OAArE,CAAD,CAAX;AACA7B,MAAAA,WAAW,CAAC,KAAD,CAAX;AACAF,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACH,KAnBD,CAmBE,OAAOY,GAAP,EAAY;AACVC,MAAAA,OAAO,CAAChB,KAAR,CAAc,2BAAd,EAA2Ce,GAA3C;AACAd,MAAAA,QAAQ,CAAC,0BAAD,CAAR;AACH;AACJ,GA1BD;;AA4BA,QAAMkC,YAAY,GAAG,MAAOjB,EAAP,IAAc;AAC/B,QAAI;AACA,YAAM1B,aAAa,CAAC0B,EAAD,CAAnB;AACArB,MAAAA,WAAW,CAACD,QAAQ,CAACwC,MAAT,CAAgBF,OAAO,IAAIA,OAAO,CAACf,GAAR,KAAgBD,EAA3C,CAAD,CAAX;AACH,KAHD,CAGE,OAAOH,GAAP,EAAY;AACVC,MAAAA,OAAO,CAAChB,KAAR,CAAc,2BAAd,EAA2Ce,GAA3C;AACAd,MAAAA,QAAQ,CAAC,0BAAD,CAAR;AACH;AACJ,GARD;;AAUA,MAAIH,OAAJ,EAAa,oBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACb,MAAIE,KAAJ,EAAW,oBAAO;AAAA,cAAMA;AAAN;AAAA;AAAA;AAAA;AAAA,UAAP;AAEX,sBACI;AAAK,IAAA,SAAS,EAAC,mBAAf;AAAA,cACKI,QAAQ,gBACL;AAAK,MAAA,SAAS,EAAC,UAAf;AAAA,8BACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFJ,eAGI;AACI,QAAA,IAAI,EAAC,MADT;AAEI,QAAA,IAAI,EAAC,MAFT;AAGI,QAAA,KAAK,EAAEE,QAAQ,CAACE,IAHpB;AAII,QAAA,QAAQ,EAAEa;AAJd;AAAA;AAAA;AAAA;AAAA,cAHJ,eASI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cATJ,eAUI;AACI,QAAA,IAAI,EAAC,MADT;AAEI,QAAA,IAAI,EAAC,UAFT;AAGI,QAAA,KAAK,EAAEf,QAAQ,CAACG,QAHpB;AAII,QAAA,QAAQ,EAAEY;AAJd;AAAA;AAAA;AAAA;AAAA,cAVJ,eAgBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAhBJ,eAiBI;AACI,QAAA,IAAI,EAAC,MADT;AAEI,QAAA,IAAI,EAAC,aAFT;AAGI,QAAA,KAAK,EAAEf,QAAQ,CAACI,WAHpB;AAII,QAAA,QAAQ,EAAEW;AAJd;AAAA;AAAA;AAAA;AAAA,cAjBJ,eAuBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAvBJ,eAwBI;AACI,QAAA,IAAI,EAAC,QADT;AAEI,QAAA,IAAI,EAAC,YAFT;AAGI,QAAA,KAAK,EAAEf,QAAQ,CAACK,UAHpB;AAII,QAAA,QAAQ,EAAEU;AAJd;AAAA;AAAA;AAAA;AAAA,cAxBJ,eA8BI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cA9BJ,eA+BI;AACI,QAAA,IAAI,EAAC,QADT;AAEI,QAAA,KAAK,EAAEf,QAAQ,CAACM,MAFpB;AAGI,QAAA,QAAQ,EAAES,gBAHd;AAAA,gCAKI;AAAQ,UAAA,KAAK,EAAC,SAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALJ,eAMI;AAAQ,UAAA,KAAK,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBANJ,eAOI;AAAQ,UAAA,KAAK,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAPJ;AAAA;AAAA;AAAA;AAAA;AAAA,cA/BJ,eAwCI;AAAQ,QAAA,OAAO,EAAEK,iBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAxCJ,eAyCI;AAAQ,QAAA,OAAO,EAAE,MAAMrB,WAAW,CAAC,KAAD,CAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAzCJ;AAAA;AAAA;AAAA;AAAA;AAAA,YADK,gBA6CL;AAAO,MAAA,SAAS,EAAC,iBAAjB;AAAA,8BACI;AAAA,+BACI;AAAA,kCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHJ,eAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJJ,eAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALJ,eAMI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBANJ,eAOI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAPJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADJ,eAYI;AAAA,kBACKT,QAAQ,CAACiC,GAAT,CAAaK,OAAO,iBACjB;AAAA,kCACI;AAAA,sBAAKA,OAAO,CAACf;AAAb;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAA,sBAAKe,OAAO,CAAC1B,IAAR,CAAa6B;AAAlB;AAAA;AAAA;AAAA;AAAA,kBAFJ,eAGI;AAAA,sBAAKH,OAAO,CAACzB,QAAR,CAAiBc;AAAtB;AAAA;AAAA;AAAA;AAAA,kBAHJ,eAII;AAAA,sBAAKW,OAAO,CAACxB,WAAR,CAAoBU,IAApB,CAAyB,IAAzB;AAAL;AAAA;AAAA;AAAA;AAAA,kBAJJ,eAKI;AAAA,sBAAKc,OAAO,CAACvB;AAAb;AAAA;AAAA;AAAA;AAAA,kBALJ,eAMI;AAAA,sBAAKuB,OAAO,CAACtB;AAAb;AAAA;AAAA;AAAA;AAAA,kBANJ,eAOI;AAAA,oCACI;AAAQ,cAAA,OAAO,EAAE,MAAMK,eAAe,CAACiB,OAAO,CAACf,GAAT,CAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAQ,cAAA,OAAO,EAAE,MAAMgB,YAAY,CAACD,OAAO,CAACf,GAAT,CAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBAPJ;AAAA,WAASe,OAAO,CAACf,GAAjB;AAAA;AAAA;AAAA;AAAA,gBADH;AADL;AAAA;AAAA;AAAA;AAAA,cAZJ;AAAA;AAAA;AAAA;AAAA;AAAA;AA9CR;AAAA;AAAA;AAAA;AAAA,UADJ;AA+EH,CA5KD;;GAAMxB,iB;;KAAAA,iB;AA8KN,eAAeA,iBAAf","sourcesContent":["// src/pages/booking/BookingManagement.jsx\r\nimport React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { getAllBookings, deleteBooking, updateBooking, getUserBookings } from '../../api/bookingApi';\r\nimport './BookingManagement.css';\r\n\r\nconst BookingManagement = () => {\r\n    const [bookings, setBookings] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const [selectedBooking, setSelectedBooking] = useState(null);\r\n    const [editMode, setEditMode] = useState(false);\r\n    const [formData, setFormData] = useState({\r\n        user: '',\r\n        schedule: '',\r\n        seatNumbers: '',\r\n        totalPrice: '',\r\n        status: '',\r\n    });\r\n\r\n    useEffect(() => {\r\n        const fetchBookings = async () => {\r\n            try {\r\n                const { data } = await getAllBookings();\r\n                setBookings(data);\r\n            } catch (err) {\r\n                setError('Failed to fetch bookings');\r\n                console.error(err);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n        fetchBookings();\r\n    }, []);\r\n\r\n    const handleEditClick = async (id) => {\r\n        try {\r\n            const { data } = await getUserBookings(id);\r\n            setSelectedBooking(data);\r\n            setFormData({\r\n                user: data.user._id,\r\n                schedule: data.schedule._id,\r\n                seatNumbers: data.seatNumbers.join(', '), // Convert array to comma-separated string\r\n                totalPrice: data.totalPrice,\r\n                status: data.status,\r\n            });\r\n            setEditMode(true);\r\n        } catch (err) {\r\n            console.error('Failed to fetch booking data:', err);\r\n            setError('Failed to fetch booking data');\r\n        }\r\n    };\r\n\r\n    const handleFormChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData({ ...formData, [name]: value });\r\n    };\r\n\r\n    const handleConfirmEdit = async () => {\r\n        setError(null);\r\n\r\n        try {\r\n            // Convert seatNumbers from string to array of numbers\r\n            const seatNumbersArray = formData.seatNumbers\r\n                .split(',')\r\n                .map(num => parseInt(num.trim(), 10));\r\n\r\n            const updatedBooking = {\r\n                user: formData.user,\r\n                schedule: formData.schedule,\r\n                seatNumbers: seatNumbersArray,\r\n                totalPrice: formData.totalPrice,\r\n                status: formData.status,\r\n            };\r\n\r\n            const { data } = await updateBooking(selectedBooking._id, updatedBooking);\r\n\r\n            setBookings(bookings.map(booking => booking._id === selectedBooking._id ? data : booking));\r\n            setEditMode(false);\r\n            setSelectedBooking(null);\r\n        } catch (err) {\r\n            console.error('Failed to update booking:', err);\r\n            setError('Failed to update booking');\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (id) => {\r\n        try {\r\n            await deleteBooking(id);\r\n            setBookings(bookings.filter(booking => booking._id !== id));\r\n        } catch (err) {\r\n            console.error('Failed to delete booking:', err);\r\n            setError('Failed to delete booking');\r\n        }\r\n    };\r\n\r\n    if (loading) return <div>Loading bookings...</div>;\r\n    if (error) return <div>{error}</div>;\r\n\r\n    return (\r\n        <div className=\"bookingManagement\">\r\n            {editMode ? (\r\n                <div className=\"editForm\">\r\n                    <h4>Edit Booking</h4>\r\n                    <label>User ID:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"user\"\r\n                        value={formData.user}\r\n                        onChange={handleFormChange}\r\n                    />\r\n                    <label>Schedule ID:</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"schedule\"\r\n                        value={formData.schedule}\r\n                        onChange={handleFormChange}\r\n                    />\r\n                    <label>Seat Numbers (comma-separated):</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        name=\"seatNumbers\"\r\n                        value={formData.seatNumbers}\r\n                        onChange={handleFormChange}\r\n                    />\r\n                    <label>Total Price:</label>\r\n                    <input\r\n                        type=\"number\"\r\n                        name=\"totalPrice\"\r\n                        value={formData.totalPrice}\r\n                        onChange={handleFormChange}\r\n                    />\r\n                    <label>Status:</label>\r\n                    <select\r\n                        name=\"status\"\r\n                        value={formData.status}\r\n                        onChange={handleFormChange}\r\n                    >\r\n                        <option value=\"ongoing\">Ongoing</option>\r\n                        <option value=\"completed\">Completed</option>\r\n                        <option value=\"cancelled\">Cancelled</option>\r\n                    </select>\r\n                    <button onClick={handleConfirmEdit}>Edit</button>\r\n                    <button onClick={() => setEditMode(false)}>Cancel</button>\r\n                </div>\r\n            ) : (\r\n                <table className=\"managementTable\">\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Booking ID</th>\r\n                            <th>User</th>\r\n                            <th>Schedule</th>\r\n                            <th>Seat Numbers</th>\r\n                            <th>Total Price</th>\r\n                            <th>Status</th>\r\n                            <th>Actions</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {bookings.map(booking => (\r\n                            <tr key={booking._id}>\r\n                                <td>{booking._id}</td>\r\n                                <td>{booking.user.username}</td>\r\n                                <td>{booking.schedule.name}</td>\r\n                                <td>{booking.seatNumbers.join(', ')}</td>\r\n                                <td>{booking.totalPrice}</td>\r\n                                <td>{booking.status}</td>\r\n                                <td>\r\n                                    <button onClick={() => handleEditClick(booking._id)}>View</button>\r\n                                    <button onClick={() => handleDelete(booking._id)}>Delete</button>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BookingManagement;\r\n"]},"metadata":{},"sourceType":"module"}