{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\OneDrive\\\\Desktop\\\\BusEase\\\\admin\\\\src\\\\context\\\\AuthContext.js\",\n    _s = $RefreshSig$();\n\n// AuthContext.js\nimport React, { createContext, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const navigate = useNavigate(); // Initialize user state from Local Storage\n\n  const [user, setUser] = useState(() => {\n    const storedUser = localStorage.getItem('user');\n    return storedUser ? JSON.parse(storedUser) : null;\n  }); // Persist user state to Local Storage whenever it changes\n\n  useEffect(() => {\n    localStorage.setItem('user', JSON.stringify(user));\n  }, [user]);\n\n  const login = async credentials => {\n    try {\n      const {\n        data\n      } = await axios.post('/api/auth/login', credentials, {\n        withCredentials: true\n      });\n\n      if (data.isAdmin) {\n        // Include isAdmin in user state\n        setUser({ ...data.details,\n          isAdmin: data.isAdmin\n        });\n        navigate('/admin'); // Redirect after successful login\n      } else {\n        alert('Access restricted to admin users only');\n      }\n    } catch (err) {\n      alert('Login failed. Please check your credentials.');\n      console.error(err);\n    }\n  };\n\n  const logout = () => {\n    setUser(null);\n    localStorage.removeItem('user'); // Remove user from Local Storage on logout\n\n    navigate('/login');\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      login,\n      logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 9\n  }, this);\n};\n\n_s(AuthProvider, \"xiqKNFM0nz4CuNu0ZwHdlKyKamg=\", false, function () {\n  return [useNavigate];\n});\n\n_c = AuthProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"sources":["C:/Users/user/OneDrive/Desktop/BusEase/admin/src/context/AuthContext.js"],"names":["React","createContext","useState","useEffect","useNavigate","axios","AuthContext","AuthProvider","children","navigate","user","setUser","storedUser","localStorage","getItem","JSON","parse","setItem","stringify","login","credentials","data","post","withCredentials","isAdmin","details","alert","err","console","error","logout","removeItem"],"mappings":";;;AAAA;AACA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,QAA/B,EAAyCC,SAAzC,QAA0D,OAA1D;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,OAAO,MAAMC,WAAW,gBAAGL,aAAa,EAAjC;AAEP,OAAO,MAAMM,YAAY,GAAG,QAAkB;AAAA;;AAAA,MAAjB;AAAEC,IAAAA;AAAF,GAAiB;AAC1C,QAAMC,QAAQ,GAAGL,WAAW,EAA5B,CAD0C,CAG1C;;AACA,QAAM,CAACM,IAAD,EAAOC,OAAP,IAAkBT,QAAQ,CAAC,MAAM;AACnC,UAAMU,UAAU,GAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAnB;AACA,WAAOF,UAAU,GAAGG,IAAI,CAACC,KAAL,CAAWJ,UAAX,CAAH,GAA4B,IAA7C;AACH,GAH+B,CAAhC,CAJ0C,CAS1C;;AACAT,EAAAA,SAAS,CAAC,MAAM;AACZU,IAAAA,YAAY,CAACI,OAAb,CAAqB,MAArB,EAA6BF,IAAI,CAACG,SAAL,CAAeR,IAAf,CAA7B;AACH,GAFQ,EAEN,CAACA,IAAD,CAFM,CAAT;;AAIA,QAAMS,KAAK,GAAG,MAAOC,WAAP,IAAuB;AACjC,QAAI;AACA,YAAM;AAAEC,QAAAA;AAAF,UAAW,MAAMhB,KAAK,CAACiB,IAAN,CAAW,iBAAX,EAA8BF,WAA9B,EAA2C;AAAEG,QAAAA,eAAe,EAAE;AAAnB,OAA3C,CAAvB;;AAEA,UAAIF,IAAI,CAACG,OAAT,EAAkB;AACd;AACAb,QAAAA,OAAO,CAAC,EAAE,GAAGU,IAAI,CAACI,OAAV;AAAmBD,UAAAA,OAAO,EAAEH,IAAI,CAACG;AAAjC,SAAD,CAAP;AACAf,QAAAA,QAAQ,CAAC,QAAD,CAAR,CAHc,CAGM;AACvB,OAJD,MAIO;AACHiB,QAAAA,KAAK,CAAC,uCAAD,CAAL;AACH;AACJ,KAVD,CAUE,OAAOC,GAAP,EAAY;AACVD,MAAAA,KAAK,CAAC,8CAAD,CAAL;AACAE,MAAAA,OAAO,CAACC,KAAR,CAAcF,GAAd;AACH;AACJ,GAfD;;AAiBA,QAAMG,MAAM,GAAG,MAAM;AACjBnB,IAAAA,OAAO,CAAC,IAAD,CAAP;AACAE,IAAAA,YAAY,CAACkB,UAAb,CAAwB,MAAxB,EAFiB,CAEgB;;AACjCtB,IAAAA,QAAQ,CAAC,QAAD,CAAR;AACH,GAJD;;AAMA,sBACI,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAAEC,MAAAA,IAAF;AAAQS,MAAAA,KAAR;AAAeW,MAAAA;AAAf,KAA7B;AAAA,cACKtB;AADL;AAAA;AAAA;AAAA;AAAA,UADJ;AAKH,CA1CM;;GAAMD,Y;UACQH,W;;;KADRG,Y","sourcesContent":["// AuthContext.js\r\nimport React, { createContext, useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const navigate = useNavigate();\r\n\r\n    // Initialize user state from Local Storage\r\n    const [user, setUser] = useState(() => {\r\n        const storedUser = localStorage.getItem('user');\r\n        return storedUser ? JSON.parse(storedUser) : null;\r\n    });\r\n\r\n    // Persist user state to Local Storage whenever it changes\r\n    useEffect(() => {\r\n        localStorage.setItem('user', JSON.stringify(user));\r\n    }, [user]);\r\n\r\n    const login = async (credentials) => {\r\n        try {\r\n            const { data } = await axios.post('/api/auth/login', credentials, { withCredentials: true });\r\n\r\n            if (data.isAdmin) {\r\n                // Include isAdmin in user state\r\n                setUser({ ...data.details, isAdmin: data.isAdmin });\r\n                navigate('/admin'); // Redirect after successful login\r\n            } else {\r\n                alert('Access restricted to admin users only');\r\n            }\r\n        } catch (err) {\r\n            alert('Login failed. Please check your credentials.');\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    const logout = () => {\r\n        setUser(null);\r\n        localStorage.removeItem('user'); // Remove user from Local Storage on logout\r\n        navigate('/login');\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, login, logout }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}